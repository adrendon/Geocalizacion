<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script>
        (function(){
            var content = document.getElementById("geolocation-test");

            if (navigator.geolocation)
            {
                navigator.geolocation.getCurrentPosition(function(objPosition)
                {
                    var lon = objPosition.coords.longitude;
                    var lat = objPosition.coords.latitude;

                    var dir = "";
                    var latlng = new google.maps.LatLng(lat, lon);
                    geocoder = new google.maps.Geocoder();
                    geocoder.geocode({"latLng": latlng}, function(results, status)
                    {
                        if (status == google.maps.GeocoderStatus.OK)
                        {
                            if (results[0])
                            {
                                dir =  results[0].formatted_address;
                            }
                            else
                            {
                                dir = "<p>No se ha podido obtener ninguna dirección en esas coordenadas.</p>";
                            }
                        }
                        else
                        {
                            dir = "<p>El Servicio de Codificación Geográfica ha fallado con el siguiente error: " + status + ".</p>";
                        }

                        //console.log( dir);
                        alert(dir);
                    });
                }, function(objPositionError){
                    switch (objPositionError.code){
                        case objPositionError.PERMISSION_DENIED:
                            content.innerHTML = "No se ha permitido el acceso a la posición del usuario.";
                            alert("No se ha permitido el acceso a la posición del usuario.");
                            break;
                        case objPositionError.POSITION_UNAVAILABLE:
                            content.innerHTML = "No se ha podido acceder a la información de su posición.";
                            alert("No se ha podido acceder a la información de su posición.");
                            break;
                        case objPositionError.TIMEOUT:
                            content.innerHTML = "El servicio ha tardado demasiado tiempo en responder.";
                            alert("El servicio ha tardado demasiado tiempo en responder.");
                            break;
                        default:
                            //content.innerHTML = "Error desconocido.";
                            alert("Error desconocido.");
                    }
                }, {
                    maximumAge: 75000,
                    timeout: 15000
                });
            }
            else
            {
                content.innerHTML = "Su navegador no soporta la API de geolocalización.";
            }
        })();
    </script>
</head>
<body>
<div id="geolocation-test"></div>

</body>
</html>
